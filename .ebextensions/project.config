files:
  "/etc/php.d/wordpress.ini" :
    mode: "000644"
    owner: root
    group: root
    content: |
      upload_max_filesize = 128M
      post_max_size = 64M

files:
  "/opt/elasticbeanstalk/hooks/appdeploy/post/99_wp_setup.sh":
    mode: "000755"
    owner: root 
    group: root 
    content: |
      #!/usr/bin/env bash
      chown -R ec2-user:ec2-user /var/app/current
      sudo su - ec2-user -c "cd /var/app/current &&
      ./vendor/bin/phing setup &&
      sudo chown -R webapp:webapp /var/app/current"

container_commands:
  SetupWp:
    command: "/opt/elasticbeanstalk/hooks/appdeploy/post/99_wp_setup.sh"
    ignoreErrors: false
    leader_only: true
